<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite App</title>

    <style>
      .css-ohj2oa {
        border: 1px solid black!important;
      }
    </style>
    
    <script async defer>
      function handleSavePage(e) {
        console.log(e)
        e.preventDefault();
        
        fetch(e.target.getAttribute('action'), {
          method: e.target.getAttribute('method'),
          headers: {
            'Content-Type': 'application/json'
          },
          body: document.querySelector('[name=content]').value
        }).then(r => r.json())
        .then(json => console.log(json));
      }

      window.addEventListener('load', () => {
        fetch('http://localhost:7000/current').then(r => r.text()).then(json => {
          document.querySelector('visual-editor').value = json;
          
          document.querySelector('form').addEventListener('submit', handleSavePage);
        });
      });
    </script>
  </head>
  <body>
    <div id="app">
      <h1>Hello Vite!</h1>

      <a href="https://vitejs.dev/guide/features.html" target="_blank">Documentation</a>

      <form action="http://localhost:7000/save" method="post">
        <visual-editor name="content"
                       preview="http://localhost:7000/preview"
                       iconsUrl="/assets/editor/[name].png"
                       value='[]'></visual-editor>
      </form>
    </div>
    <script type="module" src="/main.js"></script>
  </body>
</html>
